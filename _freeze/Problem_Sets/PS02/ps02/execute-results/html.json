{
  "hash": "87bd0d8dc7120cf1f3282ec46e1e59e4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Problem Set 02\"\nauthor: \"Michael Fehl, Francesco Zucca, Giuseppe Lista, Dominic Jones, Wu Chen\"\ndescription: \"Linear Models: Fixed Effects, First-Diffs, & Arellano-Bond\"\nproblem-set: true\nformat:\n  html:\n    embed-resources: true\n    self-contained: true\n---\n\n# Question 1:\n\n\n\n# Question 2:\n\n2. Consider the following model:\n$$y_{it} = \\alpha + x_{it}\\beta + z_{it}\\gamma + f_i + u_{it} \\quad \\text{for } i=1,\\dots,N \\text{ and } t=1,\\dots,T,$$\nwhere $x_{it}$ and $z_{it}$ are scalars, $f_i$ is a permanent unobserved effect and the error term $u_{it}$ is homoscedastic and serially uncorrelated. Furthermore, assume that $x_{it}$ is strictly exogenous:\n$$E(u_{it}|x_{i1}, \\dots, x_{iT}, f_i) = 0. \\tag{1}$$\n\na) Suppose the only thing we can safely assume is that the orthogonality condition (1) holds and you take first differences to estimate the model. For different assumptions regarding the exogeneity of $z_{it}$ and the relationship between $z_{it}$ and $f_i$, state the properties of your estimator (consistency and efficiency) when OLS is used to estimate $\\beta$ and $\\gamma$ in the first differences model?\n\n*Note* that the FD model takes the form: $\\Delta y_i = \\Delta x_i' \\beta + \\Delta z_i' \\gamma + \\Delta \\mu_i$\n\nCase 1.1: $E[f_i \\mid z_i, x_i] = 0$ & Strict exo\n\n**Consistent**\n\n**Not efficient**: random effects would be efficient model here\n\n$$\n\n$$\n\nCase 1.2: $E[f_i \\mid z_i, x_i] \\neq 0$ & Strict exo\n\n**Consistent**\n\n**Not efficient**: fixed effects would be efficient (serially correlated errors); for FD random walk is more efficient model\n\nb) Now suppose $T=5$ and the additional assumption holds:\n$$E(u_{it}|z_{i1}, \\dots, z_{it-1}, f_i) = 0.$$\n\nCase 2.1: $E[f_i \\mid z_i, x_i] = 0$ & weak exo\n\n**Inconsistent**: \n$$\n\\begin{align}\n  E[\\Delta z_{it} \\Delta \\mu_{it}] &= \\underbrace{E[z_{it} \\mu_{it}]}_{=0} - \\underbrace{E[z_{it-1} \\mu_{it}]}_{\\neq 0} \\\\\n  &- \\underbrace{E[z_{it-1} \\mu_{it}]}_{=0} - \\underbrace{E[z_{it-1} \\mu_{it-1}]}_{=0}\n  \n\\end{align}\n$$\n\nHence, when we try to apply asymptotic properties, it does **not** converge in probability to zero; rather, it converges to a non-zero value. Thus, it is not consistent.\n\nCase 2.2: $E[f_i \\mid z_i, x_i] \\neq 0$ & weak exo\n\n**Inconsistent**: \n\nb) Now suppose $T=5$ and the additional assumption holds:\n$E(\\mu_{it}|z_{i1}, ..., z_{itâˆ’1}, f_i) = 0$. (NOT weak exogenity; contemperous error terms)\n\n(i). How would you now estimate $\\beta$ and $\\gamma$ efficiently?\n\nWe need instruments to estimate our FD model *efficiently*; specifically, an instrument for $\\Delta z_{it}$\n\nNote that our error assumption does NOT include exogenity of the error term from the same time period of z. I.e., we need to make sure that our instrument does not include correlations between $\\mu_{it}$ and $z_{it}$\n\nFor example, let's explore AH (use $z_{it-1}$ as an IV): \n\n$$E[z_{it-1} \\Delta \\mu_{it}] = E[z_{it-1} \\mu_{it} - z_{it-1} \\mu_{it-1}] \\neq 0$$\n\nDoes not work -- need to go further back in time. Let's try $z_{it-2}$ as an IV\n\n$$E[z_{it-2} \\Delta \\mu_{it}] = E[z_{it-2} \\mu_{it} - z_{it-2} \\mu_{it-1}] = 0$$\n\nSo, as long as we take any IV that is at least $t-2$ periods prior (and that the regressor is still correlated with $x_{it}$)\n\nSince we have five periods; the first time period we can use is $t=3$; we cannot instrument anything earlier ($t=3, t=4, t=5$). In other words, the first regressors we can include in the model are from t=3 to t=5 ...? corresponding to ($\\Delta z_{i3}, \\Delta z_{i4}, \\Delta z_{i5}$)\n\nCase 1: $\\Delta z_{i3}$\n\n$E[z_{i1} \\Delta \\mu_{i3}] = 0$\n\nCase 2: $\\Delta z_{i4}$\n\n$E[z_{i1} \\Delta \\mu_{i4}] = 0$\n$E[z_{i2} \\Delta \\mu_{i4}] = 0$\n\nCase 3: $\\Delta z_{i5}$\n\n$E[z_{i1} \\Delta \\mu_{i5}] = 0$\n$E[z_{i2} \\Delta \\mu_{i5}] = 0$\n$E[z_{i3} \\Delta \\mu_{i5}] = 0$\n\n** These are all the moment conditions we can get; assuming we want to use this class of estimators to find all the orthogonality conditions in our model to instrument $\\Delta z_{it}$\n\nNow the question is to how to combine all of these into one big instrument matrix that we then put into our GMM estimator. The instrument matrix that we select is the following:\n\n$$\nz_i =\n\\begin{bmatrix}\n  z_{i1} &0 & 0& 0&0 &0 & \\Delta x_{i3} \\\\\n  0 & z_{i1} & z_{i1} & 0 &0 & 0& \\Delta x_{i4} \\\\\n  0 & 0 & 0 & z_{i1} & z_{i1} & z_{i1} & \\Delta x_{i5} \n\\end{bmatrix}\n$$\n\nSuch that we satisfy the condition:\n\n$$\nE[z_i' \\mu_i] = E\\left(\n\\begin{bmatrix}\n  z_{i1} &0 & 0& 0&0 &0 & \\Delta x_{i3} \\\\\n  0 & z_{i1} & z_{i1} & 0 &0 & 0& \\Delta x_{i4} \\\\\n  0 & 0 & 0 & z_{i1} & z_{i1} & z_{i1} & \\Delta x_{i5} \n\\end{bmatrix} '\n\n\\begin{bmatrix}\n  \\Delta \\mu_{i3} \\\\\n  \\Delta \\mu_{i4} \\\\\n  \\Delta \\mu_{i4}\n\\end{bmatrix}\n\n\\right) = 0\n$$\nWhich leads us to the decision to use AB estimator as we care about *efficiency*. We want each condition above to have its **own** moment condition; i.e., we use every orthogonality condition available in the model.\n\nNow we can define $k_i$ as the following:\n\n$$\nk_i = \n\\begin{bmatrix}\n  \\Delta x_{i3} & \\Delta z_{i3} \\\\\n  \\Delta x_{i4} & \\Delta z_{i4} \\\\\n  \\Delta x_{i5} & \\Delta z_{i5} \n\\end{bmatrix}\n$$\n\nWhich we plug into our standard GMM estimator form:\n\n$$\n\\hat{\\beta}_{GMM} = \\left( \\left(\\sum k_i'z_i \\right) \\hat{\\Omega}^{-1} \\left(\\sum z_i'zk_i \\right)^{-1}\n\\left(\\sum k_i'z_i \\right) \\hat{\\Omega}^{-1} \\left(\\sum z_i'\\Delta y_i \\right)\n\n\\right)\n$$\n\nNote that the weighting matrix form that gives us the min. variance takes the form:\n\n$$\nplim \\hat{ \\Omega} = Var(z_i \\Delta \\mu_i)\n$$\n\nTo achieve this, it depends on our error term assumption. If we assume homoskedasticity, we can derive the variance directly since we assume the functional form of the errors. If we have heteroskedasticity, we cannot do that (since we lack a functional for); for which we implement a two-step form. Since this problem assumes <u>homoskedasticity</u>, we can proceed with the first option.\n\n(ii). Derive the variance of your estimator.\n\nIf homoskedastic: \n\n$$\n\\hat{\\Omega} = \\frac{1}{N}\\sum_{i=1}^N z_i'\n\\begin{bmatrix}\n  2 & -1 & 0 \\\\\n  -1 & 2 & -1 \\\\\n  0 & -1 & 2 \\\\\n\\end{bmatrix}\nz_i\n$$\n\nNote that if $\\mu_{it}$ were serially correlated, our model would fail here.\n\nUsually, we are heteroskedastic. So we must get an estimate of Var(zi'deltamu_i) in the first step:\n\ni.e. an estimate for $E[z_i'\\Delta \\mu_i \\Delta \\mu_i ' z_i]$\n\nstep 1: use residuals from \\beta_{gmm} using whatever weighting matrix we want (we can even compute it the same step as above, assuming homosked)\n\n$$\n\\hat{\\Omega}_{\\text{optimal}} = \\frac{1}{N}\\sum z_i'\\Delta \\hat{\\mu}_i \\Delta \\hat{\\mu}_i ' z_i\n$$\n\n\n\nstep 2: plug in this newly found 'optimal' weighting matrix back into our GMM equation, and we find the optimal variance to take the form:\n\n$$\n\\begin{align}\n  \\widehat{Avar}(\\hat{\\beta}_{GMM}) = \\frac{1}{N}\\left(\n  \\frac{\\sum k_i' z_i}{N} \\hat{\\Omega}_{optimal}^{-1} \\frac{\\sum z_i' k_i}{N}\n  \\right)^{-1}\n\\end{align}\n$$\n\n\n\nc) Suppose $z_{it} = y_{it-1}$ and you know that $\\gamma = 1$. How would you estimate the model? Provide the estimator and its variance matrix.\n\nOur model would then take the form:\n\n$$y_{it} = \\alpha + x_{it}\\beta + y_{it-1} + f_i + u_{it} $$\n\nWhich leads us to the standard FE model:\n\n$$\\Delta y_{it} = \\alpha + x_{it}\\beta + f_i + u_{it}$$\n\nWhich leads us to the FE estimate:\n\n$$\\hat{\\beta}_{FE} = \\left(\\sum_{i=1}^N \\tilde{X}_i'\\tilde{X}_i \\right)^{-1} \\sum_{i=1}^N \\tilde{X}_i'\\Delta \\tilde{y}_i$$\n\nWhich has the following variance form:\n\n$$\\widehat{Avar}(\\hat{\\beta}_{FE}) = \\sigma^2 \\left(\\sum_{i=1}^N \\tilde{X}_i'\\tilde{X}_i \\right)^{-1}$$\n\n# Question 3: Empirical\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Statamarkdown)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.stata .cell-code}\nuse \"soep_lebensz_en.dta\", clear\n\n// question 1 //\ngen has_kids = (no_kids > 0 & no_kids != .) // has_kids dummy\nlabel var has_kids \"kids dummy\"\n\nsort id year\nby id: gen obs_no = _n \nkeep if obs_no <= 2  // only keep the first two obs for an individal\n\nby id: gen total_obs = _N\nkeep if total_obs == 2 // only keep obs with exactly two obs\n\nby id: gen year_gap = (year-year[_n-1])\nby id: egen total_gap = max(year_gap)\nkeep if total_gap == 1 // only keep obs with exactly one year differences\n\nsort id year\nxtset id year\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(SOEPINFO: Magic at Work! http://panel.gsoep.de/soepinfo/ (randomized with soep\n> no)\n\n\n\n\n\n(6,505 observations deleted)\n\n\n(683 observations deleted)\n\n(2,867 missing values generated)\n\n\n(170 observations deleted)\n\n\n\nPanel variable: id (weakly balanced)\n Time variable: year, 2000 to 2004\n         Delta: 1 unit\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n// first-diff \nreg d.satisf_std d.has_kids d.health_std d.education, noconstant\nestimate store firstdiff1\n\n// fixed effects\nxtreg satisf_std has_kids health_std education, fe\nestimate store fixed1\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\nno variables defined\nr(111);\n\nr(111);\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "ps02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}